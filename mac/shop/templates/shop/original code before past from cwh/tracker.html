<!-- {% extends 'shop/basic.html' %}

{% block title %} CheckOUT - My Awesome Cart {% endblock %}
{% block body %}

<div class="container" xmlns="http://www.w3.org/1999/html">
  <div class="col">
    <h2> My Awesome Cart Express Tracker - Enter your Order id and Email address</h2>
    <form method="post" action="/shop/tracker/" id="trackerForm">{% csrf_token %}
      <div class="form-row">
        <div class="form-group col-md-6">
          <label for="inputname">Order id</label>
          <input type="text" class="form-control" id="orderId" name="orderId" placeholder="Order Id">
        </div>
        <div class="form-group col-md-6">
          <label for="inputEmail4">Email</label>
          <input type="email" class="form-control" id="email" name="email" placeholder="Email">
        </div>
        <button type="submit" class="btn btn-primary">Track Order</button>
      </div>
      
  
  <div class="col">
    <h2>Step 2 - Enter Adress and Other Details</h2>
    <div>
      <ul class="list-group" id="items">
      </ul>
    </div>
    </form>


  </div>
</div>



{% endblock %}

{% block js %}
<script>
$('#trackerForm').submit(function(event){

  $('#items').empty();
  var formData = {
  	'orderId': $('input[name=orderId]').val(),
  	'email': $('input[name=email]').val(),
    'csrfmiddlewaretoken': $('input[name=csrfmiddlewaretoken]').val()
  }

  $.ajax({
   type:'POST',
   url: '/shop/tracker/',
   data: formData,
   encode:true

  })

 .done(function(data){
    console.log(data)
    updates = JSON.parse(data);
    if(updates.length>0 & updates!={}){

        for(i=0;i<updates.length;i++){
	        let text = updates[i]['text'];
	        let time = updates[i]['time'];
	        mystr = `<li class="list-group-item d-flex justify-content-between align-items-center">
            ${text}
             <span class="badge badge-primary badge-pill">${time}</span>
        </li>`
             $('#items').append(mystr);
        }
    }else{
	    mystr = `<li class="list-group-item d-flex justify-content-between align-items-center">
            sorry </li>`
	    $('#items').append(mystr);
    }

 });

 event.preventDefault();


});

document.getElementById('cart').innerHTML = sum;
$('#itemsJson').val(JSON.stringify(cart));
{% if thank %}
alert('Thanks for ordering with us .Your order is {{id}}. Use it to track yopur order using our order tracker');
localStorage.clear();
document.location = "/shop";
{% endif %}
</script>
{% endblock %} -->